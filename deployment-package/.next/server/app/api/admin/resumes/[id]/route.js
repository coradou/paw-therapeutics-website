"use strict";(()=>{var e={};e.id=176,e.ids=[176],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},4109:(e,t,n)=>{n.r(t),n.d(t,{headerHooks:()=>g,originalPathname:()=>y,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>f,serverHooks:()=>p,staticGenerationAsyncStorage:()=>w,staticGenerationBailout:()=>h});var r={};n.r(r),n.d(r,{GET:()=>c,PUT:()=>d});var i=n(884),a=n(6132),s=n(1040),u=n(5798),o=n(8192),l=n(2429);async function c(e,{params:t}){let n=(0,o.G3)(e);if(!n.isAuthenticated)return u.Z.json({error:"未授权访问"},{status:401});try{let e=await (0,l.getResumeById)(t.id);if(!e)return u.Z.json({error:"简历不存在"},{status:404});return u.Z.json({resume:e})}catch(e){return u.Z.json({error:"获取简历详情失败"},{status:500})}}async function d(e,{params:t}){let n=(0,o.G3)(e);if(!n.isAuthenticated)return u.Z.json({error:"未授权访问"},{status:401});try{let n=await e.json(),r=await (0,l.updateResume)(t.id,n);if(!r)return u.Z.json({error:"简历不存在"},{status:404});return u.Z.json({success:!0,resume:r})}catch(e){return u.Z.json({error:"更新简历失败"},{status:500})}}let f=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/admin/resumes/[id]/route",pathname:"/api/admin/resumes/[id]",filename:"route",bundlePath:"app/api/admin/resumes/[id]/route"},resolvedPagePath:"/Users/freeninglu/Desktop/paw-therapeutics-website-main /app/api/admin/resumes/[id]/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:w,serverHooks:p,headerHooks:g,staticGenerationBailout:h}=f,y="/api/admin/resumes/[id]/route";function v(){return(0,s.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:w})}},8192:(e,t,n)=>{n.d(t,{G3:()=>s,LC:()=>a,bD:()=>i});let r={username:"admin",password:"paw2024admin!"};function i(e,t){return e===r.username&&t===r.password}function a(e){let t={username:e,loginTime:new Date().toISOString(),exp:Date.now()+864e5};return Buffer.from(JSON.stringify(t)).toString("base64")}function s(e){let t=e.cookies.get("admin_session")?.value||e.headers.get("Authorization")?.replace("Bearer ","");return t?function(e){try{let t=JSON.parse(Buffer.from(e,"base64").toString());if(Date.now()>t.exp)return{isAuthenticated:!1};return{isAuthenticated:!0,username:t.username,loginTime:t.loginTime}}catch(e){return{isAuthenticated:!1}}}(t):{isAuthenticated:!1}}},2429:(e,t,n)=>{n.r(t),n.d(t,{getAllContacts:()=>y,getAllInterviews:()=>x,getAllResumes:()=>f,getContactById:()=>j,getContactStats:()=>A,getInterviewById:()=>J,getInterviewStats:()=>N,getResumeById:()=>p,getResumeFilePath:()=>h,getResumeStats:()=>I,saveContact:()=>v,saveInterviewData:()=>F,saveResume:()=>m,saveResumeFile:()=>g,updateContact:()=>S,updateInterview:()=>R,updateResume:()=>w});var r=n(7147),i=n(1017),a=n.n(i);let s=a().join(process.cwd(),"data"),u=a().join(s,"resumes.json"),o=a().join(s,"contacts.json"),l=a().join(s,"interviews.json"),c=a().join(s,"uploads");async function d(){try{await r.promises.mkdir(s,{recursive:!0}),await r.promises.mkdir(c,{recursive:!0})}catch(e){}}async function f(){try{await d();let e=await r.promises.readFile(u,"utf-8");return JSON.parse(e)}catch(e){return[]}}async function m(e){await d();let t=await f(),n={...e,id:O(),submittedAt:new Date().toISOString(),status:"new"};return t.push(n),await r.promises.writeFile(u,JSON.stringify(t,null,2)),n}async function w(e,t){let n=await f(),i=n.findIndex(t=>t.id===e);return -1===i?null:(n[i]={...n[i],...t},await r.promises.writeFile(u,JSON.stringify(n,null,2)),n[i])}async function p(e){let t=await f();return t.find(t=>t.id===e)||null}async function g(e,t){await d();let n=a().extname(e.name),i=`${t}${n}`,s=a().join(c,i),u=await e.arrayBuffer();return await r.promises.writeFile(s,Buffer.from(u)),i}function h(e){return a().join(c,e)}async function y(){try{await d();let e=await r.promises.readFile(o,"utf-8");return JSON.parse(e)}catch(e){return[]}}async function v(e){await d();let t=await y(),n={...e,id:O(),submittedAt:new Date().toISOString(),status:"new"};return t.unshift(n),await r.promises.writeFile(o,JSON.stringify(t,null,2)),n}async function S(e,t){let n=await y(),i=n.findIndex(t=>t.id===e);return -1===i?null:(n[i]={...n[i],...t},await r.promises.writeFile(o,JSON.stringify(n,null,2)),n[i])}async function j(e){let t=await y();return t.find(t=>t.id===e)||null}async function A(){let e=await y();return{total:e.length,new:e.filter(e=>"new"===e.status).length,read:e.filter(e=>"read"===e.status).length,replied:e.filter(e=>"replied"===e.status).length,archived:e.filter(e=>"archived"===e.status).length}}function O(){return Math.random().toString(36).substr(2,15)}async function I(){let e=await f();return{total:e.length,new:e.filter(e=>"new"===e.status).length,reviewed:e.filter(e=>"reviewed"===e.status).length,contacted:e.filter(e=>"contacted"===e.status).length,rejected:e.filter(e=>"rejected"===e.status).length,analyzed:e.filter(e=>e.aiAnalysis).length}}async function x(){try{await d();let e=await r.promises.readFile(l,"utf-8");return JSON.parse(e)}catch(e){return[]}}async function F(e){let t=await x(),n={...e,id:O(),status:"new"};return t.push(n),await r.promises.writeFile(l,JSON.stringify(t,null,2)),n}async function R(e,t){let n=await x(),i=n.findIndex(t=>t.id===e);return -1===i?null:(n[i]={...n[i],...t},await d(),await r.promises.writeFile(l,JSON.stringify(n,null,2)),n[i])}async function J(e){let t=await x();return t.find(t=>t.id===e)||null}async function N(){let e=await x(),t=e.length,n=e.filter(e=>"new"===e.status).length,r=e.filter(e=>"reviewed"===e.status).length,i=e.filter(e=>"contacted"===e.status).length,a=e.map(e=>e.evaluation.overallScore).filter(e=>e>0),s=a.length>0?Math.round(a.reduce((e,t)=>e+t,0)/a.length):0,u=e.filter(e=>"recommended"===e.evaluation.recommendation).length,o=e.filter(e=>"consider"===e.evaluation.recommendation).length,l=e.filter(e=>"not_recommended"===e.evaluation.recommendation).length;return{total:t,new:n,reviewed:r,contacted:i,rejected:e.filter(e=>"rejected"===e.status).length,averageScore:s,recommendations:{recommended:u,consider:o,notRecommended:l}}}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[271,107],()=>n(4109));module.exports=r})();