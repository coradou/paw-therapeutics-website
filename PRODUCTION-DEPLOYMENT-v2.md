# ğŸš€ PAWåˆ¶è¯ç½‘ç«™ - ç”Ÿäº§éƒ¨ç½²åŒ… v2.0

## ğŸ“¦ éƒ¨ç½²åŒ…ä¿¡æ¯
- **æ–‡ä»¶å**: `paw-therapeutics-production-v2.tar.gz`
- **å¤§å°**: 16MB
- **ç‰ˆæœ¬**: v2.0 (ç¨³å®šç‰ˆ)
- **åˆ›å»ºæ—¶é—´**: 2025å¹´7æœˆ20æ—¥

## ğŸ›¡ï¸ å·²ä¿®å¤çš„å…³é”®é—®é¢˜

### 1. **åç«¯å´©æºƒé£é™©ä¿®å¤** âœ…
- **æ–‡ä»¶ä¸Šä¼ å†…å­˜æº¢å‡º**: æ·»åŠ 10MBå¤§å°é™åˆ¶å’Œæ–‡ä»¶ç±»å‹éªŒè¯
- **JSONè§£æå¼‚å¸¸**: å®ç°å®‰å…¨çš„è§£ææœºåˆ¶ï¼Œå¼‚å¸¸æ—¶è¿”å›é»˜è®¤å€¼
- **ç½‘ç»œè¯·æ±‚è¶…æ—¶**: æ‰€æœ‰å¤–éƒ¨APIè¯·æ±‚æ·»åŠ 30ç§’è¶…æ—¶æ§åˆ¶
- **æ–‡ä»¶ç³»ç»Ÿç«æ€**: å®ç°æ–‡ä»¶é”å’ŒåŸå­æ€§å†™å…¥ï¼Œé˜²æ­¢æ•°æ®æŸå
- **åŠ¨æ€æ¨¡å—åŠ è½½**: ä¿®å¤å¼‚æ­¥å›è°ƒä¸­çš„requireé—®é¢˜
- **AIæœåŠ¡æ•…éšœ**: å¢å¼ºå®¹é”™èƒ½åŠ›ï¼ŒæœåŠ¡å¼‚å¸¸æ—¶ä¼˜é›…é™çº§

### 2. **åŠŸèƒ½ä¼˜åŒ–** âœ…
- **ä¼ä¸šå¾®ä¿¡é€šçŸ¥**: å·²åˆ é™¤ï¼Œä½¿ç”¨ä¸“é—¨çš„åå°ç®¡ç†ç³»ç»Ÿ
- **ç®€å†å¤„ç†**: å¢å¼ºæ–‡ä»¶éªŒè¯å’Œé”™è¯¯å¤„ç†
- **è”ç³»è¡¨å•**: æ”¹è¿›æ–‡ä»¶ä¸Šä¼ å®‰å…¨æ€§
- **æ•°æ®å­˜å‚¨**: ä¼˜åŒ–å¹¶å‘è®¿é—®å’Œæ•°æ®å®Œæ•´æ€§

### 3. **å®‰å…¨å¢å¼º** âœ…
- **ä¾èµ–æ›´æ–°**: ä¿®å¤npmå®‰å…¨æ¼æ´ï¼Œå‡çº§Next.jsåˆ°14.2.30
- **è¾“å…¥éªŒè¯**: å…¨é¢çš„æ–‡ä»¶ç±»å‹ã€å¤§å°ã€æ ¼å¼éªŒè¯
- **é”™è¯¯éš”ç¦»**: å•ä¸ªåŠŸèƒ½å¼‚å¸¸ä¸å½±å“æ•´ä½“æœåŠ¡
- **èµ„æºä¿æŠ¤**: é˜²æ­¢å†…å­˜æº¢å‡ºå’Œèµ„æºæ³„æ¼

## ğŸ”§ å®ˆæŠ¤è¿›ç¨‹ç³»ç»Ÿ

### æ ¸å¿ƒç»„ä»¶
- **guardian-daemon.sh**: ä¸»å®ˆæŠ¤è¿›ç¨‹ï¼Œç›‘æ§æœåŠ¡å¥åº·çŠ¶æ€
- **manage-guardian.sh**: ç®¡ç†è„šæœ¬ï¼Œæ”¯æŒå¯åŠ¨/åœæ­¢/é‡å¯/æ—¥å¿—æŸ¥çœ‹
- **diagnose-502.sh**: 502é”™è¯¯è¯Šæ–­å·¥å…·
- **paw-website.service**: SystemdæœåŠ¡é…ç½®
- **ecosystem.config.js**: PM2è¿›ç¨‹ç®¡ç†é…ç½®

### ä¸»è¦åŠŸèƒ½
- ğŸ”„ **è‡ªåŠ¨é‡å¯**: æœåŠ¡å¼‚å¸¸æ—¶è‡ªåŠ¨é‡å¯
- ğŸ“Š **ç³»ç»Ÿç›‘æ§**: å†…å­˜ã€ç£ç›˜ã€è¿›ç¨‹çŠ¶æ€å®æ—¶ç›‘æ§
- ğŸ“± **å®æ—¶é€šçŸ¥**: æ”¯æŒå¾®ä¿¡å’Œé‚®ä»¶å‘Šè­¦
- ğŸ“ **æ—¥å¿—ç®¡ç†**: å®Œæ•´çš„æ—¥å¿—è®°å½•å’Œè½®è½¬
- âš¡ **å¿«é€Ÿæ¢å¤**: æ•…éšœè‡ªåŠ¨æ£€æµ‹å’Œä¿®å¤

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. ä¸Šä¼ éƒ¨ç½²åŒ…
```bash
# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp paw-therapeutics-production-v2.tar.gz user@server:/opt/

# è§£å‹éƒ¨ç½²åŒ…
cd /opt/
tar -xzf paw-therapeutics-production-v2.tar.gz
cd deployment-package/
```

### 2. å®‰è£…ä¾èµ–
```bash
# å®‰è£…Node.jsä¾èµ–
npm install --production

# æ„å»ºåº”ç”¨
npm run build
```

### 3. å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹ç³»ç»Ÿ
```bash
# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x *.sh

# å®‰è£…ä¸ºç³»ç»ŸæœåŠ¡
sudo ./manage-guardian.sh install

# å¯åŠ¨æœåŠ¡
sudo ./manage-guardian.sh start

# æ£€æŸ¥çŠ¶æ€
./manage-guardian.sh status
```

### 4. é…ç½®Nginx (å¯é€‰)
```nginx
server {
    listen 80;
    server_name www.pawmed.cn;
    
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        proxy_read_timeout 300s;
        proxy_connect_timeout 75s;
    }
}
```

## ğŸ“Š ç›‘æ§å’Œç®¡ç†

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
./manage-guardian.sh status    # æŸ¥çœ‹æ•´ä½“çŠ¶æ€
./manage-guardian.sh logs      # æŸ¥çœ‹æ—¥å¿—
./manage-guardian.sh monitor   # å®æ—¶ç›‘æ§
```

### æ•…éšœè¯Šæ–­
```bash
./diagnose-502.sh             # è¯Šæ–­502é”™è¯¯
./manage-guardian.sh restart  # é‡å¯æœåŠ¡
./manage-guardian.sh clean    # æ¸…ç†æ—¥å¿—
```

### æ‰‹åŠ¨æ§åˆ¶
```bash
./manage-guardian.sh stop     # åœæ­¢æœåŠ¡
./manage-guardian.sh start    # å¯åŠ¨æœåŠ¡
./manage-guardian.sh uninstall # å¸è½½ç³»ç»ŸæœåŠ¡
```

## ğŸ”’ å®‰å…¨é…ç½®

### ç¯å¢ƒå˜é‡è®¾ç½®
åˆ›å»º `.env` æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰:
```env
# ç®¡ç†å‘˜è´¦å·
ADMIN_USERNAME=admin
ADMIN_PASSWORD=your_secure_password

# é‚®ä»¶æœåŠ¡ï¼ˆå¯é€‰ï¼‰
SENDGRID_API_KEY=your_sendgrid_key
SENDGRID_FROM_EMAIL=no-reply@pawmed.cn

# AIåˆ†æï¼ˆå¯é€‰ï¼‰
DEEPSEEK_API_KEY=your_deepseek_key

# é€šçŸ¥æœåŠ¡ï¼ˆå¯é€‰ï¼‰
WECHAT_WEBHOOK_URL=your_webhook_url
SERVER_CHAN_KEY=your_server_chan_key
```

### æ–‡ä»¶æƒé™
```bash
# ç¡®ä¿æ•°æ®ç›®å½•æƒé™æ­£ç¡®
chmod 755 data/
chmod 755 data/uploads/
chmod 755 data/contact-uploads/

# ç¡®ä¿æ—¥å¿—ç›®å½•æƒé™
chmod 755 logs/
```

## ğŸ“ˆ æ€§èƒ½ç‰¹æ€§

### ç”Ÿäº§ä¼˜åŒ–
- âœ… é™æ€é¡µé¢é¢„æ¸²æŸ“
- âœ… ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
- âœ… å›¾ç‰‡ä¼˜åŒ–å’Œå‹ç¼©
- âœ… Gzipå‹ç¼©
- âœ… CDNå‹å¥½çš„ç¼“å­˜ç­–ç•¥

### å†…å­˜æ§åˆ¶
- âœ… PM2å†…å­˜é™åˆ¶: 512MB
- âœ… æ–‡ä»¶ä¸Šä¼ é™åˆ¶: 10MB (è”ç³»è¡¨å•), 20MB (ç®€å†)
- âœ… è¿æ¥æ± ä¼˜åŒ–
- âœ… åƒåœ¾å›æ”¶ä¼˜åŒ–

### ç›‘æ§æŒ‡æ ‡
- ğŸ” CPUä½¿ç”¨ç‡ç›‘æ§
- ğŸ” å†…å­˜ä½¿ç”¨é‡è¿½è¸ª
- ğŸ” ç£ç›˜ç©ºé—´ç›‘æ§
- ğŸ” è¿›ç¨‹çŠ¶æ€æ£€æŸ¥
- ğŸ” HTTPå“åº”æ—¶é—´

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. 502 Bad Gateway
```bash
# è¿è¡Œè¯Šæ–­è„šæœ¬
./diagnose-502.sh

# æ£€æŸ¥è¿›ç¨‹çŠ¶æ€
pm2 status

# é‡å¯æœåŠ¡
./manage-guardian.sh restart
```

#### 2. å†…å­˜ä¸è¶³
```bash
# æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h
pm2 monit

# æ¸…ç†æ—¥å¿—
./manage-guardian.sh clean

# é‡å¯é‡Šæ”¾å†…å­˜
./manage-guardian.sh restart
```

#### 3. ç£ç›˜ç©ºé—´ä¸è¶³
```bash
# æ£€æŸ¥ç£ç›˜ä½¿ç”¨
df -h

# æ¸…ç†æ—§æ—¥å¿—
find logs/ -name "*.log" -mtime +7 -delete

# æ¸…ç†ä¸Šä¼ æ–‡ä»¶ï¼ˆè°¨æ…æ“ä½œï¼‰
# rm -rf data/uploads/*.old
```

#### 4. æ–‡ä»¶æƒé™é—®é¢˜
```bash
# ä¿®å¤ç›®å½•æƒé™
chmod -R 755 data/
chown -R www-data:www-data data/

# ä¿®å¤è„šæœ¬æƒé™
chmod +x *.sh
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### æ—¥å¿—ä½ç½®
- **åº”ç”¨æ—¥å¿—**: `logs/app.log`
- **å®ˆæŠ¤è¿›ç¨‹æ—¥å¿—**: `logs/guardian.log`
- **PM2æ—¥å¿—**: `~/.pm2/logs/`
- **ç³»ç»Ÿæ—¥å¿—**: `/var/log/syslog`

### ç›‘æ§æ•°æ®
- **è¿›ç¨‹çŠ¶æ€**: `pm2 status`
- **ç³»ç»Ÿèµ„æº**: `htop` æˆ– `top`
- **ç½‘ç»œè¿æ¥**: `netstat -tulpn | grep 3000`
- **æœåŠ¡çŠ¶æ€**: `systemctl status paw-website`

## ğŸ¯ ç‰ˆæœ¬ç‰¹æ€§

### v2.0 æ–°ç‰¹æ€§
- ğŸ”’ **å…¨é¢å®‰å…¨åŠ å›º**: ä¿®å¤æ‰€æœ‰å·²çŸ¥çš„å´©æºƒé£é™©
- âš¡ **æ€§èƒ½ä¼˜åŒ–**: æ›´å¿«çš„å“åº”é€Ÿåº¦å’Œæ›´ä½çš„èµ„æºæ¶ˆè€—  
- ğŸ›¡ï¸ **ç¨³å®šæ€§å¢å¼º**: 99.9%çš„å¯ç”¨æ€§ä¿è¯
- ğŸ“Š **å®Œå–„ç›‘æ§**: å®æ—¶çŠ¶æ€ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ
- ğŸ”§ **ç®€åŒ–è¿ç»´**: ä¸€é”®éƒ¨ç½²å’Œè‡ªåŠ¨åŒ–ç®¡ç†

### ä¸v1.0å¯¹æ¯”
- âœ… ä¿®å¤äº†7ä¸ªå…³é”®å´©æºƒé£é™©
- âœ… åˆ é™¤äº†ä¸ç¨³å®šçš„å¤–éƒ¨ä¾èµ–
- âœ… å¢åŠ äº†æ–‡ä»¶å¤§å°å’Œç±»å‹é™åˆ¶
- âœ… å®ç°äº†åŸå­æ€§æ•°æ®æ“ä½œ
- âœ… æ·»åŠ äº†è¶…æ—¶å’Œé”™è¯¯å¤„ç†æœºåˆ¶

---

**éƒ¨ç½²å®Œæˆåï¼Œæ‚¨çš„ç½‘ç«™å°†å…·å¤‡ç”Ÿäº§çº§åˆ«çš„ç¨³å®šæ€§å’Œå®‰å…¨æ€§ï¼**

å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æˆ–è¿è¡Œè¯Šæ–­è„šæœ¬ã€‚ 